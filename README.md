# Sticker-spacer polymers in active bath
This repository contains LAMMPS input scripts, data files, and generated outputs for simulations of sticker-spacer polymers immersed in passive or active Brownian particle baths. The analysis code and processed data used for figure generation are provided in the `PostProcessing/` directory, organized into `Cluster_Data/`, `Partition_Data/`, `Rg_Data/`, and `Plots/`. 

###LAMMPS input scripts and configuration files

- `Polymer_Stickers_ABP1200_Hybrid.dat`: LAMMPS data file defining the initial configuration of the sticker–spacer polymers and Brownian particle bath, including particle types, bonds, and simulation box dimensions.

- `Poly_Relax_ABP0.1_T300_E6_Pe0.in` \& `Poly_Relax_ABP0.1_T300_E6_Pe1.0.in`: LAMMPS input scripts used to relax the system with a passive (Pe = 0) and an active Brownian particle bath (Pe = 1.0). Polymer–polymer attractions are gradually introduced to obtain an equilibrated initial configuration.

- `Poly_Record_ABP0.1_T300_E6_Pe0.in` \& `Poly_Record_ABP0.1_T300_E6_Pe1.0.in`: Production run scripts for simulations with a passive (Pe = 0) and an active Brownian particle bath (Pe = 1.0). The generated outputs are processed to compute the average droplet size, partition coefficient, and polymer radius of gyration.

- `Out_Relax/`: Directory containing relaxation trajectories and restart files generated during equilibration runs.

- `Out_Record/`: Directory containing production run output files, and restart files used for post-processing and analysis.


### PostProcessing

The `PostProcessing/` directory contains the post-processing and plotting code, along with the processed data, used to generate the figures in the article:

- `Final_Plotting.py`: Script used for all post-processing and plotting. It reads processed data from the directories listed below and generates the figures saved in the `Plots/` directory.

- `Cluster_Data/`: Droplet (cluster) size as a function of Pe. This data is used to generate Fig. 6B.

- `Partition_Data/`: Partition coefficient data for different Pe values. This data is used to compute the average partition coefficient shown in Fig. 6C.

- `Rg_Data/`: Radius of gyration of the polymer in the dense and dilute phases for lower and higher binding affinities ($\epsilon = 4,\, 6$) at Pe = 0 and Pe = 0.5. This data is used to generate the Supporting Information figure.

- `Plots/`: Final plots used in the paper. 


## How to run the simulations and post-process the data

All simulations were performed using LAMMPS (27 June 2024 version) compiled with MPI support. Parallel execution was employed for both relaxation and production runs using a hybrid MPI–OpenMP configuration, with 16 MPI processes and 2 OpenMP threads per process, enabled via the `-sf omp` and `-pk omp` options.

## Requirements
- LAMMPS (27 June 2024 version or newer), compiled with MPI and OpenMP support.
- MPI library (e.g., OpenMPI or MPICH).
- Python 3 (for post-processing and plotting).
  
- **Running the simulations:**  
  Each simulation consists of an initial relaxation run, followed by a production run that is started from the corresponding relaxed configuration. Relaxation runs generate equilibrated configurations as restart files in the `Out_Relax/` directory, while production runs write XYZ trajectory and restart files to the `Out_Record/` directory.

  Simulations are executed in parallel using MPI as:

  ```bash
  mpirun -np N lmp -sf omp -pk omp 2 -in Poly_Relax_ABP0.1_T300_E6_Pe0.in
  mpirun -np N lmp -sf omp -pk omp 2 -in Poly_Record_ABP0.1_T300_E6_Pe0.in

Here, `N` is the number of MPI processes (we used `N = 16` for all simulations). The `-sf omp` and `-pk omp 2` flags enable OpenMP threading within each MPI process.

- All figures can be regenerated by running:
  
```bash
python3 Final_Plotting.py


